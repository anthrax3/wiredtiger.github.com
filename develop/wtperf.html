<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>WiredTiger: Simulating workloads with wtperf</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="wiredtiger.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><a href="http://wiredtiger.com/"><img alt="Logo" src="LogoFinal-header.png" alt="WiredTiger" /></a></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">
   &#160;<span id="projectnumber">Version 2.3.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<div class="banner">
  <a href="https://github.com/wiredtiger/wiredtiger">Fork me on GitHub</a>
  <a class="last" href="http://groups.google.com/group/wiredtiger-users">Join my user group</a>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.3.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
      <li><a href="community.html"><span>Community</span></a></li>
      <li><a href="license.html"><span>License</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('wtperf.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">Simulating workloads with wtperf </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The WiredTiger distribution includes a tool that can be used to simulate workloads in WiredTiger, in the directory <code>bench/wtperf</code>.</p>
<p>The <code>wtperf</code> utility generally has two phases, the populate phase which creates a database and then populates an object in that database, and a workload phase, that does some set of operations on the object.</p>
<p>For example, the following configuration uses a single thread to populate a file object with 500,000 records in a 500MB cache. The workload phase consists of 8 threads running for two minutes, all reading from the file.</p>
<div class="fragment"><div class="line">conn_config=<span class="stringliteral">&quot;cache_size=500MB&quot;</span></div>
<div class="line">table_config=<span class="stringliteral">&quot;type=file&quot;</span></div>
<div class="line">icount=500000</div>
<div class="line">run_time=120</div>
<div class="line">populate_threads=1</div>
<div class="line">threads=((count=8,reads=1))</div>
</div><!-- fragment --><p>The <code>conn_config</code> configuration supports setting any WiredTiger connection configuration value. This is commonly used to configure statistics with regular reports, to obtain more information from the run:</p>
<div class="fragment"><div class="line">conn_config=<span class="stringliteral">&quot;cache_size=20G,statistics=(fast,clear),statistics_log=(wait=600)&quot;</span></div>
<div class="line">report_interval=5</div>
</div><!-- fragment --><p>Note that quoting must be used when passing values to Wiredtiger configuration as opposed to configuring the <code>wtperf</code> utility.</p>
<p>The <code>table_config</code> configuration supports setting any WiredTiger object creation configuration value, for example, the above test can be converted to using an LSM store instead of a B+tree store, with additional LSM configuration by changing <code>conn_config</code> to:</p>
<div class="fragment"><div class="line">table_config=<span class="stringliteral">&quot;lsm=(chunk_size=5MB),type=lsm,os_cache_dirty_max=16MB&quot;</span></div>
</div><!-- fragment --><p>More complex workloads can be configured by creating more threads doing inserts and updates as well as reads. For example, to configure two inserting threads, two reading threads and two updating threads:</p>
<div class="fragment"><div class="line">threads=((count=2,inserts=1),(count=2,reads=1),(count=2,updates=1))</div>
</div><!-- fragment --><p>Some of the standard <code>wtperf</code> configurations we run can be found in the <code>bench/wtperf/runners/</code> directory.</p>
<p>The following is a list of the currently available <code>wtperf</code> configuration options:</p>
<dl class="section user"><dt>async_threads (unsigned int, default=0)</dt><dd>number of async worker threads </dd></dl>
<dl class="section user"><dt>checkpoint_interval (unsigned int, default=120)</dt><dd>checkpoint every interval seconds during the workload phase. </dd></dl>
<dl class="section user"><dt>checkpoint_stress_rate (unsigned int, default=0)</dt><dd>checkpoint every rate operations during the populate phase in the populate thread(s), 0 to disable </dd></dl>
<dl class="section user"><dt>checkpoint_threads (unsigned int, default=0)</dt><dd>number of checkpoint threads </dd></dl>
<dl class="section user"><dt>conn_config (string, default=create)</dt><dd>connection configuration string </dd></dl>
<dl class="section user"><dt>compact (boolean, default=false)</dt><dd>post-populate compact for LSM merging activity </dd></dl>
<dl class="section user"><dt>compression (string, default=none)</dt><dd>compression extension. Allowed configuration values are: 'none', 'bzip', 'snappy', 'zlib' </dd></dl>
<dl class="section user"><dt>create (boolean, default=true)</dt><dd>do population phase; false to use existing database </dd></dl>
<dl class="section user"><dt>database_count (unsigned int, default=1)</dt><dd>number of WiredTiger databases to use. Each database will execute the workload using a separate home directory and complete set of worker threads </dd></dl>
<dl class="section user"><dt>icount (unsigned int, default=5000)</dt><dd>number of records to initially populate. If multiple tables are configured, each table has this many items inserted. </dd></dl>
<dl class="section user"><dt>insert_rmw (boolean, default=false)</dt><dd>execute a read prior to each insert in workload phase </dd></dl>
<dl class="section user"><dt>key_sz (unsigned int, default=20)</dt><dd>key size </dd></dl>
<dl class="section user"><dt>min_throughput (unsigned int, default=0)</dt><dd>abort if any throughput measured is less than this amount. Requires sample_interval to be configured </dd></dl>
<dl class="section user"><dt>max_latency (unsigned int, default=0)</dt><dd>abort if any latency measured exceeds this number of milliseconds.Requires sample_interval to be configured </dd></dl>
<dl class="section user"><dt>pareto (boolean, default=false)</dt><dd>use pareto 80/20 distribution for random numbers </dd></dl>
<dl class="section user"><dt>populate_ops_per_txn (unsigned int, default=0)</dt><dd>number of operations to group into each transaction in the populate phase, zero for auto-commit </dd></dl>
<dl class="section user"><dt>populate_threads (unsigned int, default=1)</dt><dd>number of populate threads, 1 for bulk load </dd></dl>
<dl class="section user"><dt>random_range (unsigned int, default=0)</dt><dd>if non zero choose a value from within this range as the key for insert operations </dd></dl>
<dl class="section user"><dt>random_value (boolean, default=false)</dt><dd>generate random content for the value </dd></dl>
<dl class="section user"><dt>report_interval (unsigned int, default=2)</dt><dd>output throughput information every interval seconds, 0 to disable </dd></dl>
<dl class="section user"><dt>run_ops (unsigned int, default=0)</dt><dd>total read, insert and update workload operations </dd></dl>
<dl class="section user"><dt>run_time (unsigned int, default=0)</dt><dd>total workload seconds </dd></dl>
<dl class="section user"><dt>sample_interval (unsigned int, default=0)</dt><dd>performance logging every interval seconds, 0 to disable </dd></dl>
<dl class="section user"><dt>sample_rate (unsigned int, default=50)</dt><dd>how often the latency of operations is measured. One for every operation,two for every second operation, three for every third operation etc. </dd></dl>
<dl class="section user"><dt>sess_config (string, default=)</dt><dd>session configuration string </dd></dl>
<dl class="section user"><dt>table_config (string, default=key_format=S,value_format=S,type=lsm,exclusive=true,allocation_size=4kb,internal_page_max=64kb,leaf_page_max=4kb,split_pct=100)</dt><dd>table configuration string </dd></dl>
<dl class="section user"><dt>table_count (unsigned int, default=1)</dt><dd>number of tables to run operations over. Keys are divided evenly over the tables. Default 1, maximum 99. </dd></dl>
<dl class="section user"><dt>threads (string, default=)</dt><dd>workload configuration: each 'count' entry is the total number of threads, and the 'insert', 'read' and 'update' entries are the ratios of insert, read and update operations done by each worker thread; multiple workload configurations may be specified; for example, a more complex threads configuration might be 'threads=((count=2,reads=1)(count=8,reads=1,inserts=2,updates=1))' which would create 2 threads doing nothing but reads and 8 threads each doing 50% inserts and 25% reads and updates. Allowed configuration values are 'count', 'reads', 'inserts', 'updates' </dd></dl>
<dl class="section user"><dt>transaction_config (string, default=)</dt><dd>transaction configuration string, relevant when populate_opts_per_txn is nonzero </dd></dl>
<dl class="section user"><dt>table_name (string, default=test)</dt><dd>table name </dd></dl>
<dl class="section user"><dt>value_sz (unsigned int, default=100)</dt><dd>value size </dd></dl>
<dl class="section user"><dt>verbose (unsigned int, default=1)</dt><dd>verbosity </dd></dl>
<dl class="section user"><dt>warmup (unsigned int, default=0)</dt><dd>How long to run the workload phase before starting measurements </dd></dl>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Reference Guide</a></li><li class="navelem"><a class="el" href="programming.html">Writing WiredTiger applications</a></li>
    <li class="footer">Copyright (c) 2008-2014 WiredTiger, Inc.  All rights reserved.  Contact <a href="mailto:info@wiredtiger.com">info@wiredtiger.com</a> for more information.</li>
  </ul>
</div>
</body>
</html>
